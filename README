A rewritten work to https://lab.imjs.work/wmpdcalc.html by @jshensh